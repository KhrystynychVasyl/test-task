<!DOCTYPE html>
<html lang="en">

<head>
    <title>TEST TASK</title>
</head>

<body>
    <form>
        <input type="text" id="addText">
        <input type="submit" id="addButton" value="Add"><span id="message"></span>
        <br>
        <div class="test"></div>
        <div class="test2"></div>
        <br>
        <div id="list">
            <input type="checkbox"> Bread <br>
            <input type="checkbox"> Milk <br>
            <input type="checkbox"> Meat <br>
        </div>
    </form>

    <script>
        const addText = document.querySelector('#addText');
        const message = document.querySelector('#message');
        const list = document.querySelector('#list');

        let count = 0;

        const addButton = document.querySelector('#addButton');
        addButton.addEventListener('click', addButtonPressed);

        function addButtonPressed(e) {
            e.preventDefault();
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    const serverAnswer = JSON.parse(xhr.responseText);
                    if (serverAnswer.message === 'Added') {
                        message.innerHTML = ' Added';
                        message.style.color = 'green';
                        document.querySelector('.test').innerHTML = JSON.stringify({item: addText.value});
                        document.querySelector('.test2').innerHTML = JSON.parse(document.querySelector('.test').innerHTML).item;
                        list.innerHTML += `<input type="checkbox"> ${addText.value} <br>`;
                        addText.value = '';
                    }
                    if (serverAnswer.message === 'Already added') {
                        message.innerHTML = ' Already added';
                        message.style.color = 'red';
                        addText.value = '';
                    }
                }

            }
            xhr.open('GET', 'server.json', true);
            xhr.setRequestHeader('Content-Type', 'application/json')
            xhr.send();
        }
    </script>
</body>

</html>
